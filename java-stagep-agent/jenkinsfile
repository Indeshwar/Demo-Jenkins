pipeline{
    agent{
        docker{
            image 'maven:3.8.1-adoptopenjdk-11'
        }
    }

    stages{
        stage('Clone the Project'){
           git branch: 'main', url: 'github.com:Indeshwar/DemoSpringProject.git' 
        }

        stage('Compilation'){
            sh "./mvnw clean install -DskipTests"
        }

        stage('Test and Deployment'){
            stage('Running unit tests'){
                sh "./mvnw test -Punit"
            }

            stage('Deployment'){
                sh 'nohup ./mvnw spring-boot:run -Dserver.port=8081 &'
            }

        }

    
    }
}